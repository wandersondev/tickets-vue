{"version":3,"file":"expand.js","names":["useProxiedModel","inject","provide","toRaw","toRef","propsFactory","makeDataTableExpandProps","expandOnClick","Boolean","showExpand","expanded","type","Array","default","VDataTableExpandedKey","Symbol","for","provideExpanded","props","v","Set","values","expand","item","value","newExpanded","rawValue","find","x","delete","add","isExpanded","some","toggleExpand","data","useExpanded","Error"],"sources":["../../../../src/components/VDataTable/composables/expand.ts"],"sourcesContent":["// Composables\nimport { useProxiedModel } from '@/composables/proxiedModel'\n\n// Utilities\nimport { inject, provide, toRaw, toRef } from 'vue'\nimport { propsFactory } from '@/util'\n\n// Types\nimport type { InjectionKey, PropType, Ref } from 'vue'\nimport type { DataTableItem } from '../types'\n\nexport const makeDataTableExpandProps = propsFactory({\n  expandOnClick: Boolean,\n  showExpand: Boolean,\n  expanded: {\n    type: Array as PropType<readonly string[]>,\n    default: () => ([]),\n  },\n}, 'DataTable-expand')\n\nexport const VDataTableExpandedKey: InjectionKey<{\n  expand: (item: DataTableItem, value: boolean) => void\n  expanded: Ref<Set<string>>\n  expandOnClick: Ref<boolean | undefined>\n  isExpanded: (item: DataTableItem) => boolean\n  toggleExpand: (item: DataTableItem) => void\n}> = Symbol.for('vuetify:datatable:expanded')\n\ntype ExpandProps = {\n  expandOnClick: boolean\n  expanded: readonly string[]\n  'onUpdate:expanded': ((value: any[]) => void) | undefined\n}\n\nexport function provideExpanded (props: ExpandProps) {\n  const expandOnClick = toRef(() => props.expandOnClick)\n  const expanded = useProxiedModel(props, 'expanded', props.expanded, v => {\n    return new Set(v)\n  }, v => {\n    return [...v.values()]\n  })\n\n  function expand (item: DataTableItem, value: boolean) {\n    const newExpanded = new Set(expanded.value)\n    const rawValue = toRaw(item.value)\n\n    if (!value) {\n      const item = [...expanded.value].find(x => toRaw(x) === rawValue)!\n      newExpanded.delete(item)\n    } else {\n      newExpanded.add(rawValue)\n    }\n\n    expanded.value = newExpanded\n  }\n\n  function isExpanded (item: DataTableItem) {\n    const rawValue = toRaw(item.value)\n    return [...expanded.value].some(x => toRaw(x) === rawValue)\n  }\n\n  function toggleExpand (item: DataTableItem) {\n    expand(item, !isExpanded(item))\n  }\n\n  const data = { expand, expanded, expandOnClick, isExpanded, toggleExpand }\n\n  provide(VDataTableExpandedKey, data)\n\n  return data\n}\n\nexport function useExpanded () {\n  const data = inject(VDataTableExpandedKey)\n\n  if (!data) throw new Error('foo')\n\n  return data\n}\n"],"mappings":"AAAA;AAAA,SACSA,eAAe,gDAExB;AACA,SAASC,MAAM,EAAEC,OAAO,EAAEC,KAAK,EAAEC,KAAK,QAAQ,KAAK;AAAA,SAC1CC,YAAY,kCAErB;AAIA,OAAO,MAAMC,wBAAwB,GAAGD,YAAY,CAAC;EACnDE,aAAa,EAAEC,OAAO;EACtBC,UAAU,EAAED,OAAO;EACnBE,QAAQ,EAAE;IACRC,IAAI,EAAEC,KAAoC;IAC1CC,OAAO,EAAEA,CAAA,KAAO;EAClB;AACF,CAAC,EAAE,kBAAkB,CAAC;AAEtB,OAAO,MAAMC,qBAMX,GAAGC,MAAM,CAACC,GAAG,CAAC,4BAA4B,CAAC;AAQ7C,OAAO,SAASC,eAAeA,CAAEC,KAAkB,EAAE;EACnD,MAAMX,aAAa,GAAGH,KAAK,CAAC,MAAMc,KAAK,CAACX,aAAa,CAAC;EACtD,MAAMG,QAAQ,GAAGV,eAAe,CAACkB,KAAK,EAAE,UAAU,EAAEA,KAAK,CAACR,QAAQ,EAAES,CAAC,IAAI;IACvE,OAAO,IAAIC,GAAG,CAACD,CAAC,CAAC;EACnB,CAAC,EAAEA,CAAC,IAAI;IACN,OAAO,CAAC,GAAGA,CAAC,CAACE,MAAM,CAAC,CAAC,CAAC;EACxB,CAAC,CAAC;EAEF,SAASC,MAAMA,CAAEC,IAAmB,EAAEC,KAAc,EAAE;IACpD,MAAMC,WAAW,GAAG,IAAIL,GAAG,CAACV,QAAQ,CAACc,KAAK,CAAC;IAC3C,MAAME,QAAQ,GAAGvB,KAAK,CAACoB,IAAI,CAACC,KAAK,CAAC;IAElC,IAAI,CAACA,KAAK,EAAE;MACV,MAAMD,IAAI,GAAG,CAAC,GAAGb,QAAQ,CAACc,KAAK,CAAC,CAACG,IAAI,CAACC,CAAC,IAAIzB,KAAK,CAACyB,CAAC,CAAC,KAAKF,QAAQ,CAAE;MAClED,WAAW,CAACI,MAAM,CAACN,IAAI,CAAC;IAC1B,CAAC,MAAM;MACLE,WAAW,CAACK,GAAG,CAACJ,QAAQ,CAAC;IAC3B;IAEAhB,QAAQ,CAACc,KAAK,GAAGC,WAAW;EAC9B;EAEA,SAASM,UAAUA,CAAER,IAAmB,EAAE;IACxC,MAAMG,QAAQ,GAAGvB,KAAK,CAACoB,IAAI,CAACC,KAAK,CAAC;IAClC,OAAO,CAAC,GAAGd,QAAQ,CAACc,KAAK,CAAC,CAACQ,IAAI,CAACJ,CAAC,IAAIzB,KAAK,CAACyB,CAAC,CAAC,KAAKF,QAAQ,CAAC;EAC7D;EAEA,SAASO,YAAYA,CAAEV,IAAmB,EAAE;IAC1CD,MAAM,CAACC,IAAI,EAAE,CAACQ,UAAU,CAACR,IAAI,CAAC,CAAC;EACjC;EAEA,MAAMW,IAAI,GAAG;IAAEZ,MAAM;IAAEZ,QAAQ;IAAEH,aAAa;IAAEwB,UAAU;IAAEE;EAAa,CAAC;EAE1E/B,OAAO,CAACY,qBAAqB,EAAEoB,IAAI,CAAC;EAEpC,OAAOA,IAAI;AACb;AAEA,OAAO,SAASC,WAAWA,CAAA,EAAI;EAC7B,MAAMD,IAAI,GAAGjC,MAAM,CAACa,qBAAqB,CAAC;EAE1C,IAAI,CAACoB,IAAI,EAAE,MAAM,IAAIE,KAAK,CAAC,KAAK,CAAC;EAEjC,OAAOF,IAAI;AACb","ignoreList":[]}