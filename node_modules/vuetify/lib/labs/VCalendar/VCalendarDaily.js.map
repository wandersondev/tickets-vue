{"version":3,"file":"VCalendarDaily.js","names":["VIconBtn","makeCalendarBaseProps","makeCalendarWithIntervalsProps","useCalendarWithIntervals","vResize","nextTick","onMounted","ref","convertToUnit","defineComponent","getPrefixedEventHandlers","useRender","VCalendarDaily","name","directives","props","color","String","shortWeekdays","type","Boolean","default","shortIntervals","hideHeader","setup","_ref","slots","attrs","scrollPush","scrollArea","pane","base","init","onResize","value","getScrollPush","offsetWidth","genHead","_createElementVNode","marginRight","genHeadIntervals","genHeadDays","width","intervalWidth","days","map","genHeadDay","day","index","events","nativeEvent","getSlotScope","_mergeProps","date","getRelativeClasses","genHeadWeekday","genHeadDayLabel","genDayHeader","week","present","undefined","getColorProps","text","weekdayFormatter","genHeadDayButton","_createVNode","dayFormatter","genBody","genScrollArea","genPane","height","bodyHeight","genDayContainer","genBodyIntervals","genDays","getTimestampAtEvent","genDayIntervals","genDayBody","intervals","genDayInterval","interval","intervalHeight","styler","intervalStyle","intervalStyleDefault","time","_normalizeStyle","parsedStart","genIntervalLabels","length","genIntervalLabel","short","shower","showIntervalLabel","showIntervalLabelDefault","show","label","intervalFormatter","_withDirectives","_normalizeClass","class","e","preventDefault","quiet"],"sources":["../../../src/labs/VCalendar/VCalendarDaily.tsx"],"sourcesContent":["// Components\nimport { VIconBtn } from '@/labs/VIconBtn'\n\n// Composables\nimport { makeCalendarBaseProps } from './composables/calendarBase'\nimport { makeCalendarWithIntervalsProps, useCalendarWithIntervals } from './composables/calendarWithIntervals'\n\n// Directives\nimport vResize from '@/directives/resize'\n\n// Utilities\nimport { nextTick, onMounted, ref } from 'vue'\nimport { convertToUnit, defineComponent, getPrefixedEventHandlers, useRender } from '@/util'\n\n// Types\nimport type { CalendarTimestamp } from './types'\n\nexport const VCalendarDaily = defineComponent({\n  name: 'VCalendarDaily',\n\n  directives: { vResize },\n\n  props: {\n    color: String,\n    shortWeekdays: {\n      type: Boolean,\n      default: true,\n    },\n    shortIntervals: {\n      type: Boolean,\n      default: true,\n    },\n    hideHeader: Boolean,\n\n    ...makeCalendarBaseProps(),\n    ...makeCalendarWithIntervalsProps(),\n  },\n\n  setup (props, { slots, attrs }) {\n    const scrollPush = ref(0)\n    const scrollArea = ref<HTMLElement>()\n    const pane = ref<HTMLElement>()\n\n    const base = useCalendarWithIntervals(props)\n\n    function init () {\n      nextTick(onResize)\n    }\n\n    function onResize () {\n      scrollPush.value = getScrollPush()\n    }\n\n    function getScrollPush (): number {\n      return scrollArea.value && pane.value\n        ? (scrollArea.value.offsetWidth - pane.value.offsetWidth)\n        : 0\n    }\n\n    function genHead () {\n      return (\n        <div\n          class=\"v-calendar-daily__head\"\n          style={{ marginRight: scrollPush.value + 'px' }}\n        >\n          { genHeadIntervals() }\n          { genHeadDays() }\n        </div>\n      )\n    }\n\n    function genHeadIntervals () {\n      const width: string | undefined = convertToUnit(props.intervalWidth)\n      return (\n        <div\n          class=\"v-calendar-daily__intervals-head\"\n          style={{ width }}\n        >\n          { slots['interval-header']?.() }\n        </div>\n      )\n    }\n\n    function genHeadDays () {\n      return base.days.value.map(genHeadDay)\n    }\n\n    function genHeadDay (day: CalendarTimestamp, index: number) {\n      const events = getPrefixedEventHandlers(attrs, ':day', nativeEvent => ({\n        nativeEvent, ...base.getSlotScope(day),\n      }))\n      return (\n        <div\n          key={ day.date }\n          class={['v-calendar-daily_head-day', base.getRelativeClasses(day)]}\n          { ...events }\n        >\n          { genHeadWeekday(day) }\n          { genHeadDayLabel(day) }\n          { genDayHeader(day, index) }\n        </div>\n      )\n    }\n\n    function genDayHeader (day: CalendarTimestamp, index: number) {\n      return slots['day-header']?.({\n        week: base.days.value,\n        ...day,\n        index,\n      }) ?? []\n    }\n\n    function genHeadWeekday (day: CalendarTimestamp) {\n      const color = day.present ? props.color : undefined\n      return (\n        <div\n          { ...base.getColorProps({ text: color }) }\n          class=\"v-calendar-daily_head-weekday\"\n        >\n          { base.weekdayFormatter.value(day, props.shortWeekdays) }\n        </div>\n      )\n    }\n\n    function genHeadDayLabel (day: CalendarTimestamp) {\n      return (\n        <div class=\"v-calendar-daily_head-day-label\">\n          { slots['day-label-header']?.(day) ?? genHeadDayButton(day) }\n        </div>\n      )\n    }\n\n    function genHeadDayButton (day: CalendarTimestamp) {\n      const events = getPrefixedEventHandlers(attrs, ':date', nativeEvent => ({\n        nativeEvent, ...day,\n      }))\n      return (\n        <VIconBtn\n          active={ day.present }\n          activeColor={ props.color }\n          variant={ props.color ? 'flat' : 'tonal' }\n          baseVariant=\"text\"\n          { ...events }\n        >\n          { base.dayFormatter.value(day, false) }\n        </VIconBtn>\n      )\n    }\n\n    function genBody () {\n      return (\n        <div class=\"v-calendar-daily__body\">\n          { genScrollArea() }\n        </div>\n      )\n    }\n\n    function genScrollArea () {\n      return (\n        <div ref={ scrollArea } class=\"v-calendar-daily__scroll-area\">\n          { genPane() }\n        </div>\n      )\n    }\n\n    function genPane () {\n      return (\n        <div\n          ref={ pane }\n          class=\"v-calendar-daily__pane\"\n          style={{ height: convertToUnit(base.bodyHeight.value) }}\n        >\n          { genDayContainer() }\n        </div>\n      )\n    }\n\n    function genDayContainer () {\n      return (\n        <div class=\"v-calendar-daily__day-container\">\n          { genBodyIntervals() }\n          { slots.days?.() ?? genDays() }\n        </div>\n      )\n    }\n\n    function genDays () {\n      return base.days.value.map((day, index) => {\n        const events = getPrefixedEventHandlers(attrs, ':time', nativeEvent => ({\n          nativeEvent,\n          ...base.getSlotScope(base.getTimestampAtEvent(nativeEvent, day)),\n        }))\n        return (\n          <div\n            key={ day.date }\n            class={['v-calendar-daily__day', base.getRelativeClasses(day)]}\n            { ...events }\n          >\n            { genDayIntervals(index) }\n            { genDayBody(day) }\n          </div>\n        )\n      })\n    }\n\n    function genDayBody (day: CalendarTimestamp) {\n      return slots['day-body']?.(base.getSlotScope(day)) ?? []\n    }\n\n    function genDayIntervals (index: number) {\n      return base.intervals.value[index].map(genDayInterval)\n    }\n\n    function genDayInterval (interval: CalendarTimestamp) {\n      const height: string | undefined = convertToUnit(props.intervalHeight)\n      const styler = props.intervalStyle || base.intervalStyleDefault\n      return (\n        <div\n          class=\"v-calendar-daily__day-interval\"\n          key={ interval.time }\n          style={[{ height }, styler(interval)]}\n        >\n          { slots.interval?.(base.getSlotScope(interval)) }\n        </div>\n      )\n    }\n\n    function genBodyIntervals () {\n      const width: string | undefined = convertToUnit(props.intervalWidth)\n      const events = getPrefixedEventHandlers(attrs, ':interval', nativeEvent => ({\n        nativeEvent, ...base.getTimestampAtEvent(nativeEvent, base.parsedStart.value),\n      }))\n      return (\n        <div\n          class=\"v-calendar-daily__intervals-body\"\n          style={{ width }}\n          { ...events }\n        >\n          { genIntervalLabels() }\n        </div>\n      )\n    }\n\n    function genIntervalLabels () {\n      if (!base.intervals.value.length) return null\n      return base.intervals.value[0].map(genIntervalLabel)\n    }\n\n    function genIntervalLabel (interval: CalendarTimestamp) {\n      const height: string | undefined = convertToUnit(props.intervalHeight)\n      const short = props.shortIntervals\n      const shower = props.showIntervalLabel || base.showIntervalLabelDefault\n      const show = shower(interval)\n      const label = show ? base.intervalFormatter.value(interval, short) : undefined\n      return (\n        <div\n          key={ interval.time }\n          class=\"v-calendar-daily__interval\"\n          style={{ height }}\n        >\n          <div class=\"v-calendar-daily__interval-text\">\n            { label }\n          </div>\n        </div>\n      )\n    }\n\n    onMounted(init)\n\n    useRender(() => (\n      <div\n        class={['v-calendar-daily', attrs.class]}\n        onDragstart={ (e: MouseEvent) => e.preventDefault() }\n        v-resize_quiet={ onResize }\n      >\n        { !props.hideHeader ? genHead() : undefined }\n        { genBody() }\n      </div>\n    ))\n\n    return {\n      ...base,\n      scrollPush,\n      scrollArea,\n      pane,\n      init,\n      onResize,\n      getScrollPush,\n    }\n  },\n})\n\nexport type VCalendarDaily = InstanceType<typeof VCalendarDaily>\n"],"mappings":"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","ignoreList":[]}