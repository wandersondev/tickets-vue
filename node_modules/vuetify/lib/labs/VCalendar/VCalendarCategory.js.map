{"version":3,"file":"VCalendarCategory.js","names":["VCalendarDaily","makeCalendarBaseProps","makeCalendarWithIntervalsProps","useCalendarWithIntervals","computed","getParsedCategories","convertToUnit","defineComponent","getPrefixedEventHandlers","useRender","VCalendarCategory","name","props","categories","type","Array","String","default","categoryText","Function","categoryForInvalid","setup","_ref","slots","attrs","base","parsedCategories","getCategoryScope","scope","category","cat","categoryName","genDayHeader","_createElementVNode","value","map","genDayHeaderCategory","day","headerTitle","events","getSlotScope","_mergeProps","genDayHeaderCategoryTitle","genDays","days","forEach","d","j","length","fill","push","v","i","genDay","index","categoryIndex","e","getTimestampAtEvent","date","getRelativeClasses","genDayIntervals","genDayBody","intervals","genDayInterval","interval","height","intervalHeight","styler","intervalStyle","intervalStyleDefault","time","_normalizeStyle","genDayBodyCategory","_createVNode"],"sources":["../../../src/labs/VCalendar/VCalendarCategory.tsx"],"sourcesContent":["// Components\nimport { VCalendarDaily } from './VCalendarDaily'\n\n// Composables\nimport { makeCalendarBaseProps } from './composables/calendarBase'\nimport { makeCalendarWithIntervalsProps, useCalendarWithIntervals } from './composables/calendarWithIntervals'\n\n// Utilities\nimport { computed } from 'vue'\nimport { getParsedCategories } from './util/parser'\nimport { convertToUnit, defineComponent, getPrefixedEventHandlers, useRender } from '@/util'\n\n// Types\nimport type { PropType } from 'vue'\nimport type { CalendarCategory, CalendarCategoryTextFunction, CalendarTimestamp } from './types'\n\nexport const VCalendarCategory = defineComponent({\n  name: 'VCalendarCategory',\n\n  props: {\n    categories: {\n      type: [Array, String] as PropType<CalendarCategory[] | string>,\n      default: '',\n    },\n    categoryText: [String, Function] as PropType<string | CalendarCategoryTextFunction>,\n    categoryForInvalid: {\n      type: String,\n      default: '',\n    },\n\n    ...makeCalendarBaseProps(),\n    ...makeCalendarWithIntervalsProps(),\n  },\n\n  setup (props, { slots, attrs }) {\n    const base = useCalendarWithIntervals(props)\n\n    const parsedCategories = computed((): CalendarCategory[] => {\n      return getParsedCategories(props.categories, props.categoryText)\n    })\n\n    function getCategoryScope (scope: any, category: CalendarCategory) {\n      const cat = typeof category === 'object' && category &&\n          category.categoryName === props.categoryForInvalid ? null : category\n      return {\n        ...scope,\n        category: cat,\n      }\n    }\n\n    function genDayHeader (scope: CalendarTimestamp & { week: any, index: number }) {\n      return (\n        <div class=\"v-calendar-category__columns\">\n          { parsedCategories.value.map(category => {\n            return genDayHeaderCategory(scope, getCategoryScope(scope, category))\n          })}\n        </div>\n      )\n    }\n\n    function genDayHeaderCategory (day: CalendarTimestamp, scope: any) {\n      const headerTitle = typeof scope.category === 'object' ? scope.category.categoryName : scope.category\n      const events = getPrefixedEventHandlers(attrs, ':dayCategory', () => {\n        return getCategoryScope(base.getSlotScope(day) || day, scope.category)\n      })\n      return (\n        <div\n          class=\"v-calendar-category__column-header\"\n          { ...events }\n        >\n          { slots.category?.(scope) ?? genDayHeaderCategoryTitle(headerTitle) }\n          { slots['day-header']?.(scope) }\n        </div>\n      )\n    }\n\n    function genDayHeaderCategoryTitle (categoryName: string | null) {\n      return (\n        <div class=\"v-calendar-category__category\">\n          { categoryName === null ? props.categoryForInvalid : categoryName }\n        </div>\n      )\n    }\n\n    function genDays () {\n      const days: any[] = []\n      base.days.value.forEach((d: CalendarTimestamp, j: number) => {\n        const day = new Array(parsedCategories.value.length || 1)\n        day.fill(d)\n        days.push(...day.map((v: CalendarTimestamp, i: number) => genDay(v, j, i)))\n      })\n      return days\n    }\n\n    function genDay (day: CalendarTimestamp, index: number, categoryIndex: number) {\n      const category = parsedCategories.value[categoryIndex]\n      const events = getPrefixedEventHandlers(attrs, ':time', e => {\n        return base.getSlotScope(base.getTimestampAtEvent(e, day))\n      })\n      return (\n        <div\n          key={ day.date + '-' + categoryIndex }\n          class={['v-calendar-daily__day', base.getRelativeClasses(day)]}\n          { ...events }\n        >\n          { genDayIntervals(index, category) }\n          { genDayBody(day, category) }\n        </div>\n      )\n    }\n\n    function genDayIntervals (index: number, category: CalendarCategory) {\n      return base.intervals.value[index].map((v: CalendarTimestamp) => genDayInterval(v, category))\n    }\n\n    function genDayInterval (interval: CalendarTimestamp, category: CalendarCategory) {\n      const height: string | undefined = convertToUnit(props.intervalHeight)\n      const styler = props.intervalStyle || base.intervalStyleDefault\n\n      return (\n        <div\n          key={ interval.time }\n          class=\"v-calendar-daily__day-interval\"\n          style={[{ height }, styler({ ...interval, category })]}\n        >\n          { slots.interval?.(\n            getCategoryScope(base.getSlotScope(interval), category)\n          )}\n        </div>\n      )\n    }\n\n    function genDayBody (day: CalendarTimestamp, category: CalendarCategory) {\n      return (\n        <div class=\"v-calendar-category__columns\">\n          { genDayBodyCategory(day, category) }\n        </div>\n      )\n    }\n\n    function genDayBodyCategory (day: CalendarTimestamp, category: CalendarCategory) {\n      const events = getPrefixedEventHandlers(attrs, ':timeCategory', e => {\n        return getCategoryScope(\n          base.getSlotScope(base.getTimestampAtEvent(e, day)),\n          category\n        )\n      })\n\n      return (\n        <div class=\"v-calendar-category__column\" { ...events }>\n          { slots['day-body']?.(getCategoryScope(base.getSlotScope(day), category)) }\n        </div>\n      )\n    }\n\n    useRender(() => (\n      <VCalendarDaily\n        class={[\n          'v-calendar-daily',\n          'v-calendar-category',\n        ]}\n        { ...props }\n      >\n        {{\n          ...slots,\n          days: genDays,\n          'day-header': genDayHeader,\n        }}\n      </VCalendarDaily>\n    ))\n\n    return {\n      ...base,\n      parsedCategories,\n    }\n  },\n})\n\nexport type VCalendarCategory = InstanceType<typeof VCalendarCategory>\n"],"mappings":"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","ignoreList":[]}